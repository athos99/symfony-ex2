{% extends 'bootstrap_3_layout.html.twig' %}




{%- block form_widget_simple -%}
    {{ parent() }}
    {% if autocomplete is defined %}
        <script type="text/javascript">
            $(document).ready(function () {
                var {{ id }} =
                new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
prefetch : '{{ url(autocomplete.route, { (autocomplete.search): 'p' }) }}',
                    remote: {
                        url: '{{ url(autocomplete.route, { (autocomplete.search): ':query' }) }}',
                        wildcard: '{{ ':query' }}'
                    }
                });
                var $t = $('#{{ id }}').typeahead({
                    minLength:  {% if autocomplete.minLength is defined %} {{ autocomplete.minLength }} {% else %} 1 {% endif %},
                    highlight:  {% if autocomplete.highlight is defined %} {{ autocomplete.highlight ? 'true' : 'false' }} {% else %} true {% endif %}
                }, {
                    source: {{ id }},
                    name: "{{ id }}",
                    limit:  {% if autocomplete.limit is defined %} {{ autocomplete.limit }} {% else %} 5 {% endif %}
                    {% if autocomplete.display is defined %}, display: '{{ autocomplete.display }}' {% endif %}
                });
                {% if autocomplete.key is defined and autocomplete.input_key is defined %}
                var $input_key = $("input[name='{{ autocomplete.input_key }}']");
                $t.bind('typeahead:selected', function (e, item) {
                    $input_key.val(item['{{ autocomplete.key }}']);
                });
                $t.bind('typeahead:autocomplete', function (e, item) {
                    $input_key.val(item['{{ autocomplete.key }}']);
                });
                $t.bind('typeahead:change', function (e, item) {
                    $input_key.val(item['{{ autocomplete.key }}']);
                });
                {% endif %}
            });
        </script>
    {% endif %}
{%- endblock form_widget_simple -%}

